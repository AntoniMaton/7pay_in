

db_client.calc_fees
 - тут если задан dealer_deals и у него есть своя такс за оплату данного дела (услуги)
то на выходе получим меньшую величину - как раз нужную нам к оплате - чтобы диллер с нас снял больше



    vol_out_new, tax_rep = db_client.calc_fees(db, deal, dealer_deal, curr_in, curr_out, volume_in,
             best_rate, is_order, note=1)


Если задать - dealer_deal = None - то мы получим ту сумму которую с нас должен снять диллер со всеми своими накрутками


    volume_in, mess_in = db_client.calc_fees_back(db, deal, dealer_deal, curr_in, curr_out, volume_out,
                                       best_rate, is_order, note=0)



ТАК при создании заказ на курс - мы в него вставляем курс с учетом диллерских - так что там получится на выходе маленькое значение
точно так же поступаем и с входящим платежами по свободному курсу - берем с учетом дилерских все -
-- так чтобы сумма платежа была маленькая - к ней еще с верху диллер с нас накрутит-сдерет

если мы В ПЭЙ уменьшаем сумму платежа - диллер накпучивает свои % и записывает в ТАКЕН
ed_common.pay(
    ## проверка тут http://127.0.0.1:8000/ipay3_dvlp/tool_deal/fees/BTC/4049/100/1
 -- уменьшает сумму платежа так чтобы с нас взяли в итоге ту сумму которая без накрутки диллера была расчитана
    volume_out, _ = db_client.dealer_deal_tax_add(db, None, fee_rate, dealer_deal, '', volume_out_full, '')

 - мы смотрим сколько с нас
ревльно взяли и тогда уже насчитываем разницу ТУ_ПЭЙ serv_pay



значит везде платим без учета диллерских накруток - и при создании заказа на курс тоже - заказ создаем без учета диллерских тогда